/Users/apple/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:34: NotOpenSSLWarning: urllib3 v2.0 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
============================= test session starts ==============================
platform darwin -- Python 3.9.6, pytest-8.4.2, pluggy-1.6.0
rootdir: /Users/apple/pyfund
configfile: pyproject.toml
plugins: mock-3.15.1, anyio-4.11.0, langsmith-0.4.31, Faker-37.8.0, cov-7.0.0
collected 3 items

tests/test_data_baseline.py FF.                                          [100%]

=================================== FAILURES ===================================
_______________________ test_data_fetcher_get_price_mock _______________________

mocker = <pytest_mock.plugin.MockerFixture object at 0x13a4ae880>

    def test_data_fetcher_get_price_mock(mocker):
        # Mock yfinance download
        mock_df = pd.DataFrame({
            "Open": [100.0, 101.0],
            "High": [102.0, 103.0],
            "Low": [99.0, 100.0],
            "Close": [101.0, 102.0],
            "Volume": [1000, 1100]
        }, index=pd.to_datetime(["2025-01-01", "2025-01-02"]))
    
        mocker.patch("yfinance.download", return_value=mock_df)
    
        # By default it returns Polars now
        df = DataFetcher.get_price("AAPL", period="2d", cache=False, as_polars=True)
    
>       assert isinstance(df, pl.DataFrame)
E       AssertionError: assert False
E        +  where False = isinstance(             Open   High    Low  Close  Volume\ndate                                          \n2025-01-01  100.0  102.0   99.0  101.0    1000\n2025-01-02  101.0  103.0  100.0  102.0    1100, <class 'polars.dataframe.frame.DataFrame'>)
E        +    where <class 'polars.dataframe.frame.DataFrame'> = pl.DataFrame

tests/test_data_baseline.py:22: AssertionError
_________________________ test_data_processor_resample _________________________

    def test_data_processor_resample():
        df = pl.DataFrame({
            "date": pd.to_datetime(["2025-01-01", "2025-01-02", "2025-01-03", "2025-01-04"]),
            "Open": [100.0, 101.0, 102.0, 103.0],
            "High": [102.0, 103.0, 104.0, 105.0],
            "Low": [99.0, 100.0, 101.0, 102.0],
            "Close": [101.0, 102.0, 103.0, 104.0],
            "Volume": [1000, 1100, 1200, 1300]
        })
    
        # Resample to 2-day frequency ('2d' in Polars)
        resampled = DataProcessor.resample(df, rule="2d")
    
>       assert len(resampled) == 2
E       assert 3 == 2
E        +  where 3 = len(shape: (3, 6)\n┌─────────────────────┬───────┬───────┬───────┬───────┬────────┐\n│ date                ┆ Open  ┆ High  ┆...04 00:00:00 ┆ 103.0 ┆ 105.0 ┆ 102.0 ┆ 104.0 ┆ 1300   │\n└─────────────────────┴───────┴───────┴───────┴───────┴────────┘)

tests/test_data_baseline.py:40: AssertionError
----------------------------- Captured stdout call -----------------------------
{"rule": "2d", "rows": 3, "event": "data_resampled", "level": "info", "timestamp": "2026-01-04 00:24:26", "func_name": "resample", "lineno": 53, "filename": "processor.py"}
=========================== short test summary info ============================
FAILED tests/test_data_baseline.py::test_data_fetcher_get_price_mock - Assert...
FAILED tests/test_data_baseline.py::test_data_processor_resample - assert 3 == 2
========================= 2 failed, 1 passed in 12.32s =========================
