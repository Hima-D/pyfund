/Users/apple/Library/Python/3.9/lib/python/site-packages/urllib3/__init__.py:34: NotOpenSSLWarning: urllib3 v2.0 only supports OpenSSL 1.1.1+, currently the 'ssl' module is compiled with 'LibreSSL 2.8.3'. See: https://github.com/urllib3/urllib3/issues/3020
  warnings.warn(
============================= test session starts ==============================
platform darwin -- Python 3.9.6, pytest-8.4.2, pluggy-1.6.0
rootdir: /Users/apple/pyfund
configfile: pyproject.toml
plugins: mock-3.15.1, anyio-4.11.0, langsmith-0.4.31, Faker-37.8.0, cov-7.0.0
{"event": "Scheduler initialized | Jobstore: sqlite | Workers: 10", "level": "info", "timestamp": "2026-01-04 00:26:17", "filename": "scheduler.py", "func_name": "__init__", "lineno": 59}
{"event": "AutomationRunner initialized in PAPER mode", "level": "info", "timestamp": "2026-01-04 00:26:17", "filename": "runner.py", "func_name": "__init__", "lineno": 27}
pyfund.strategies loaded - 14 professional strategies ready
collected 3 items

tests/test_data_baseline.py {"ticker": "AAPL", "source": "yfinance", "interval": "1d", "event": "fetching_data", "level": "info", "timestamp": "2026-01-04 00:26:18", "filename": "fetcher.py", "func_name": "_fetch_and_clean", "lineno": 94}
.{"rule": "2d", "rows": 3, "event": "data_resampled", "level": "info", "timestamp": "2026-01-04 00:26:19", "filename": "processor.py", "func_name": "resample", "lineno": 53}
shape: (3, 6)
┌─────────────────────┬───────┬───────┬───────┬───────┬────────┐
│ date                ┆ Open  ┆ High  ┆ Low   ┆ Close ┆ Volume │
│ ---                 ┆ ---   ┆ ---   ┆ ---   ┆ ---   ┆ ---    │
│ datetime[ns]        ┆ f64   ┆ f64   ┆ f64   ┆ f64   ┆ i64    │
╞═════════════════════╪═══════╪═══════╪═══════╪═══════╪════════╡
│ 2024-12-31 00:00:00 ┆ 100.0 ┆ 102.0 ┆ 99.0  ┆ 101.0 ┆ 1000   │
│ 2025-01-02 00:00:00 ┆ 101.0 ┆ 104.0 ┆ 100.0 ┆ 103.0 ┆ 2300   │
│ 2025-01-04 00:00:00 ┆ 103.0 ┆ 105.0 ┆ 102.0 ┆ 104.0 ┆ 1300   │
└─────────────────────┴───────┴───────┴───────┴───────┴────────┘
F{"method": "ffill", "rows": 4, "event": "data_cleaned", "level": "info", "timestamp": "2026-01-04 00:26:19", "filename": "processor.py", "func_name": "clean_and_fill", "lineno": 82}
{"method": "both", "rows": 4, "event": "data_cleaned", "level": "info", "timestamp": "2026-01-04 00:26:19", "filename": "processor.py", "func_name": "clean_and_fill", "lineno": 82}
.

=================================== FAILURES ===================================
_________________________ test_data_processor_resample _________________________

    def test_data_processor_resample():
        df = pl.DataFrame({
            "date": pd.to_datetime(["2025-01-01", "2025-01-02", "2025-01-03", "2025-01-04"]),
            "Open": [100.0, 101.0, 102.0, 103.0],
            "High": [102.0, 103.0, 104.0, 105.0],
            "Low": [99.0, 100.0, 101.0, 102.0],
            "Close": [101.0, 102.0, 103.0, 104.0],
            "Volume": [1000, 1100, 1200, 1300]
        })
    
        # Resample to 2-day frequency ('2d' in Polars)
        resampled = DataProcessor.resample(df, rule="2d")
    
        if len(resampled) != 2:
            print(resampled)
    
>       assert len(resampled) == 2
E       assert 3 == 2
E        +  where 3 = len(shape: (3, 6)\n┌─────────────────────┬───────┬───────┬───────┬───────┬────────┐\n│ date                ┆ Open  ┆ High  ┆...04 00:00:00 ┆ 103.0 ┆ 105.0 ┆ 102.0 ┆ 104.0 ┆ 1300   │\n└─────────────────────┴───────┴───────┴───────┴───────┴────────┘)

tests/test_data_baseline.py:43: AssertionError
=========================== short test summary info ============================
FAILED tests/test_data_baseline.py::test_data_processor_resample - assert 3 == 2
========================= 1 failed, 2 passed in 9.20s ==========================
